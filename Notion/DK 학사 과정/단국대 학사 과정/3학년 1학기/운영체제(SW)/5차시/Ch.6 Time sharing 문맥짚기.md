> [!info] 운영체제(Operating System) 핵심 개념 정리 (3) - Process  
> Process의 정의  
> [https://wkdtjsgur100.github.io/os-summary-process/](https://wkdtjsgur100.github.io/os-summary-process/)  
**선요약**
직접수행
+제어 메카니즘1: 제한된 수행
+제어 메카니즘2: 타이머 인터럽트를 통한 문맥 교환
  
![[Source/Untitled 111.png|Untitled 111.png]]
  
  
  
Time Sharing(시분할)은 CPU 가상화의 핵심 기술이다.
시분할을 구현할 때 고려해야하는 이슈들이 있다.
1. 성능
    
    어떻게 가상화의 오버헤드를 최소화할까?
    
2. 제어
    
    어떻게 CPU에 대한 제어를 유지하면서 프로세스들을 효율적으로 동작시킬까?
    
      
    
프로그램을 기대만큼 빠르게 동작시키기위해서 특별한 기술을 고안해낼 필요는 없다.
Limited direct execution(제한된 직접 수행)을 사용하면 된다.

먼저 직접 수행이 무엇인지 알아보자.
![[Source/Untitled 1 72.png|Untitled 1 72.png]]
OS의 프로그램 실행 준비 → 프로그램 실행 → 프로그램 완료(종료) → OS의 메모리 정리 및 프로세스 리스트에서 제거
이게 전부다. 매우 간단하다.
  
하지만 직접 수행은 CPU 가상화에 있어 몇가지 문제가 존재한다.
1. 프로그램이 우리가 원하지 않는 일을 하지 않도록 하면서도 효율적으로 실행할 수 있게 할까?
2. 우리가 프로세스를 실행할 때, 운영 시스템은 어떻게 그 프로세스의 실행을 멈추고 다른 프로세스로 전환하여, CPU를 가상화하는데 필요한 시분할을 구현할 수 있을까?
  
---
## 제한된 작업을 어떻게 수행할까?(유저모드, 커널모드)
---
직접 실행은 프로그램이 하드웨어 CPU에서 네이티브로 실행되므로 예상대로 빠르게 실행된다는 명백한 장점이 있다.
그러나 CPU에서 실행하는 것은 문제를 야기한다: 프로세스가 디스크에 I/O 요청을 발행하거나 CPU나 메모리와 같은 더 많은 시스템 자원에 접근하고자 하는 등의 ==제한된 작업==을 수행하고자 할 경우는 어떻게 될까?
- ~~미리 보는 요약~~
    
    유저모드, 커널모드를 도입하여 유저모드의 프로세스는 시스템 호출을 통해 제한된 작업을 수행하도록 한다.
    
    시스템 호출을 실행하기 위해 트랩 명렁어를 사용해, 권한을 커널 모드로 상승시키고 필요한 작업을 모두 마친 후 return-from-trap 명령어를 통해 유저 모드로 되돌아온다.
    
  
단순히 모든 프로세스가 IO 관련 작업을 원하는 대로 마음껏 수행하도록 허용하면 어떨까?
프로세스가 전체 디스크를 자유롭게 읽고 쓸 수 있게 되어 모든 보호 기능이 상실될 것이다.
  
이를 해결하기 위해 User mode / Kernel mode라고 불리는 새로운 프로세서 모드를 도입한다.
User mode에서 실행되는 코드는 할 수 있는 작업에 제한이 있다.
유저 모드에서 실행되는 프로세스는 IO요청을 할 수 없고, 만약 이를 시도한다면 운영체제는 예외를 띄우고 해당 프로세스를 종료할 것이다.
  
그럼 사용자 프로세스(유저 모드의 프로세스)가 IO작업을 수행하고자 한다면 어떻게 해야하나?
이를 가능하게 하기 위해 OS는 ==System call(시스템 호출)==을 제공한다.
  
시스템 호출을 실행하기 위해 프로그램은 트랩 명령어를 실행해야한다.
이 명령어는 커널로 점프하며 권한 수준을 커널 모드로 상승시킨다.
커널 내에서 필요한 작업 수행을 마친 후, OS는 특별한 return-from-trap 명령어를 호출하여 유저 모드로 되돌린다.
  
이러한 트랩 메커니즘에서 트랩이 OS 내부의 어떤 코드를 실행해야하는지 어떻게 알까?
이를 해결하기위해 커널은 부팅 시 ==트랩 테이블==을 설정한다.
이 테이블은 하드웨어에 특정 이벤트(예: 하드디스크 인터럽트, 키보드 인터럽트, 시스템 호출 등)가 발생했을 때 실행해야 할 코드의 위치를 알려준다.
하드웨어는 이 테이블에 기록된 정보를 기반으로 예외적인 이벤트가 발생했을 때 어떤 트랩 핸들러 코드로 점프해야 하는지를 알고, 이를 통해 시스템의 안정성과 보안을 유지하며 필요한 처리를 수행할 수 있습니다.
  
---
## 수행 프로세스 교체는 어떻게 할까?(타이머 인터럽트)
---
![[Source/Untitled 2 51.png|Untitled 2 51.png]]
  
타이머 인터럽트를 통해 제어권을 OS으로 가져온다.
S