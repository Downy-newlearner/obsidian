C:\Obsidian\obsidian\1. Projects\DeepLearning_Cloud\강의 노트\16장_RNN\chap16_source_code\16_LSTM.py:24: UserWarning: Could not infer format, so each element will be parsed individually, falling back to `dateutil`. To ensure parsing is consistent and as-expected, please specify a format.
  df['Adjustments'] = pd.to_datetime(df['Adjustments']) + \
             Unadjusted  Seasonally adjusted
Adjustments
1991-01-31     12588862             15026890
1991-02-28     12154321             15304585
1991-03-31     14337072             15413591
1991-04-30     15108570             15293409
1991-05-31     17225734             15676083
(228, 12)
[[0.20091289 0.13173822 0.11139526 ... 0.0704258  0.         0.01402033]
 [0.03002688 0.20091289 0.13173822 ... 0.09531795 0.0704258  0.        ]
 [0.01999285 0.03002688 0.20091289 ... 0.16362761 0.09531795 0.0704258 ]
 ...
 [0.79916654 0.81439355 0.86398323 ... 0.92972161 0.71629034 0.77368724]
 [0.80210057 0.79916654 0.81439355 ... 0.59734863 0.92972161 0.71629034]
 [0.81482896 0.80210057 0.79916654 ... 0.53166512 0.59734863 0.92972161]]
(228, 1)
[[0.03002688]
 [0.01999285]
 [0.06596369]
 [0.10983126]
 [0.14912986]
 [0.14718865]
 [0.14464787]
 [0.11898427]
 [0.11802682]
 [0.14222108]
 [0.12459168]
 [0.24290801]
 [0.04899091]
 [0.02408276]
 [0.09865054]
 [0.14480155]
 [0.17061844]
 [0.17067229]
 [0.17603636]
 [0.1449117 ]
 [0.14957943]
 [0.15381982]
 [0.16036484]
 [0.28308682]
 [0.05971347]
 [0.05306762]
 [0.15199345]
 [0.17230214]
 [0.21246911]
 [0.23131079]
 [0.1982186 ]
 [0.19187716]
 [0.19381714]
 [0.18857277]
 [0.20528237]
 [0.33988685]
 [0.08949179]
 [0.07634802]
 [0.17110473]
 [0.1813207 ]
 [0.24477833]
 [0.26344575]
 [0.21272045]
 [0.22992482]
 [0.21637497]
 [0.19432483]
 [0.21967685]
 [0.32763379]
 [0.10404607]
 [0.10865653]
 [0.17613776]
 [0.20220558]
 [0.27328997]
 [0.2563439 ]
 [0.2345309 ]
 [0.24956867]
 [0.2076314 ]
 [0.24301971]
 [0.26259735]
 [0.34664092]
 [0.15254749]
 [0.12516393]
 [0.19588324]
 [0.26708559]
 [0.33685655]
 [0.3040439 ]
 [0.30379872]
 [0.28752567]
 [0.27032929]
 [0.30125039]
 [0.28232982]
 [0.43082597]
 [0.18009842]
 [0.14979522]
 [0.23406626]
 [0.30158962]
 [0.3600297 ]
 [0.33879489]
 [0.3368581 ]
 [0.30194637]
 [0.30623203]
 [0.31747715]
 [0.30028829]
 [0.44267202]
 [0.20274588]
 [0.17760526]
 [0.28806833]
 [0.33661957]
 [0.3787159 ]
 [0.38338551]
 [0.38202348]
 [0.34756011]
 [0.3494253 ]
 [0.34391949]
 [0.34906009]
 [0.51590214]
 [0.23134986]
 [0.22540502]
 [0.34731361]
 [0.3471628 ]
 [0.43574656]
 [0.44496501]
 [0.40869778]
 [0.4177841 ]
 [0.40511349]
 [0.37210241]
 [0.40014795]
 [0.54536552]
 [0.27274385]
 [0.23522688]
 [0.37097737]
 [0.39415779]
 [0.49789489]
 [0.48686133]
 [0.43085023]
 [0.45714625]
 [0.39071414]
 [0.41180809]
 [0.44829621]
 [0.59131807]
 [0.32932249]
 [0.27853753]
 [0.40293353]
 [0.45979935]
 [0.54634659]
 [0.52297663]
 [0.50842735]
 [0.5177832 ]
 [0.44848221]
 [0.48324201]
 [0.48792681]
 [0.61774744]
 [0.35967234]
 [0.31704851]
 [0.42956839]
 [0.48091095]
 [0.589258  ]
 [0.54068475]
 [0.55942183]
 [0.54681611]
 [0.4940774 ]
 [0.51847144]
 [0.49162047]
 [0.65082633]
 [0.37505799]
 [0.35020985]
 [0.47795221]
 [0.5303576 ]
 [0.59124821]
 [0.5987484 ]
 [0.60476993]
 [0.56078827]
 [0.55143842]
 [0.55790149]
 [0.55102743]
 [0.72294807]
 [0.39828492]
 [0.38310797]
 [0.5306343 ]
 [0.59517044]
 [0.63865532]
 [0.67152856]
 [0.66032145]
 [0.6411306 ]
 [0.60530204]
 [0.58357841]
 [0.60250285]
 [0.79282179]
 [0.44650736]
 [0.41859717]
 [0.60030859]
 [0.64375378]
 [0.73370373]
 [0.73869353]
 [0.71586416]
 [0.73856667]
 [0.67440441]
 [0.63484111]
 [0.66171541]
 [0.85345467]
 [0.50409226]
 [0.46442449]
 [0.66672364]
 [0.69262367]
 [0.84791621]
 [0.81956809]
 [0.75762571]
 [0.80093142]
 [0.7067105 ]
 [0.70711449]
 [0.74005813]
 [0.89864748]
 [0.59274697]
 [0.55703637]
 [0.67018796]
 [0.77815322]
 [0.89130104]
 [0.82881558]
 [0.85429556]
 [0.82665694]
 [0.7738504 ]
 [0.77447937]
 [0.7122942 ]
 [0.84218578]
 [0.54973668]
 [0.4726908 ]
 [0.619567  ]
 [0.70299771]
 [0.8118506 ]
 [0.79730487]
 [0.80781639]
 [0.7709681 ]
 [0.75444661]
 [0.77368724]
 [0.71629034]
 [0.92972161]
 [0.59734863]
 [0.53166512]
 [0.73605008]
 [0.78453641]
 [0.84759795]
 [0.8653115 ]
 [0.86398323]
 [0.81439355]
 [0.79916654]
 [0.80210057]
 [0.81482896]
 [1.        ]]
Final DATASET
(228, 12, 1)
[[[0.20091289]
  [0.13173822]
  [0.11139526]
  ...
  [0.0704258 ]
  [0.        ]
  [0.01402033]]

 [[0.03002688]
  [0.20091289]
  [0.13173822]
  ...
  [0.09531795]
  [0.0704258 ]
  [0.        ]]

 [[0.01999285]
  [0.03002688]
  [0.20091289]
  ...
  [0.16362761]
  [0.09531795]
  [0.0704258 ]]

 ...

 [[0.79916654]
  [0.81439355]
  [0.86398323]
  ...
  [0.92972161]
  [0.71629034]
  [0.77368724]]

 [[0.80210057]
  [0.79916654]
  [0.81439355]
  ...
  [0.59734863]
  [0.92972161]
  [0.71629034]]

 [[0.81482896]
  [0.80210057]
  [0.79916654]
  ...
  [0.53166512]
  [0.59734863]
  [0.92972161]]]
[[0.03002688]
 [0.01999285]
 [0.06596369]
 [0.10983126]
 [0.14912986]
 [0.14718865]
 [0.14464787]
 [0.11898427]
 [0.11802682]
 [0.14222108]
 [0.12459168]
 [0.24290801]
 [0.04899091]
 [0.02408276]
 [0.09865054]
 [0.14480155]
 [0.17061844]
 [0.17067229]
 [0.17603636]
 [0.1449117 ]
 [0.14957943]
 [0.15381982]
 [0.16036484]
 [0.28308682]
 [0.05971347]
 [0.05306762]
 [0.15199345]
 [0.17230214]
 [0.21246911]
 [0.23131079]
 [0.1982186 ]
 [0.19187716]
 [0.19381714]
 [0.18857277]
 [0.20528237]
 [0.33988685]
 [0.08949179]
 [0.07634802]
 [0.17110473]
 [0.1813207 ]
 [0.24477833]
 [0.26344575]
 [0.21272045]
 [0.22992482]
 [0.21637497]
 [0.19432483]
 [0.21967685]
 [0.32763379]
 [0.10404607]
 [0.10865653]
 [0.17613776]
 [0.20220558]
 [0.27328997]
 [0.2563439 ]
 [0.2345309 ]
 [0.24956867]
 [0.2076314 ]
 [0.24301971]
 [0.26259735]
 [0.34664092]
 [0.15254749]
 [0.12516393]
 [0.19588324]
 [0.26708559]
 [0.33685655]
 [0.3040439 ]
 [0.30379872]
 [0.28752567]
 [0.27032929]
 [0.30125039]
 [0.28232982]
 [0.43082597]
 [0.18009842]
 [0.14979522]
 [0.23406626]
 [0.30158962]
 [0.3600297 ]
 [0.33879489]
 [0.3368581 ]
 [0.30194637]
 [0.30623203]
 [0.31747715]
 [0.30028829]
 [0.44267202]
 [0.20274588]
 [0.17760526]
 [0.28806833]
 [0.33661957]
 [0.3787159 ]
 [0.38338551]
 [0.38202348]
 [0.34756011]
 [0.3494253 ]
 [0.34391949]
 [0.34906009]
 [0.51590214]
 [0.23134986]
 [0.22540502]
 [0.34731361]
 [0.3471628 ]
 [0.43574656]
 [0.44496501]
 [0.40869778]
 [0.4177841 ]
 [0.40511349]
 [0.37210241]
 [0.40014795]
 [0.54536552]
 [0.27274385]
 [0.23522688]
 [0.37097737]
 [0.39415779]
 [0.49789489]
 [0.48686133]
 [0.43085023]
 [0.45714625]
 [0.39071414]
 [0.41180809]
 [0.44829621]
 [0.59131807]
 [0.32932249]
 [0.27853753]
 [0.40293353]
 [0.45979935]
 [0.54634659]
 [0.52297663]
 [0.50842735]
 [0.5177832 ]
 [0.44848221]
 [0.48324201]
 [0.48792681]
 [0.61774744]
 [0.35967234]
 [0.31704851]
 [0.42956839]
 [0.48091095]
 [0.589258  ]
 [0.54068475]
 [0.55942183]
 [0.54681611]
 [0.4940774 ]
 [0.51847144]
 [0.49162047]
 [0.65082633]
 [0.37505799]
 [0.35020985]
 [0.47795221]
 [0.5303576 ]
 [0.59124821]
 [0.5987484 ]
 [0.60476993]
 [0.56078827]
 [0.55143842]
 [0.55790149]
 [0.55102743]
 [0.72294807]
 [0.39828492]
 [0.38310797]
 [0.5306343 ]
 [0.59517044]
 [0.63865532]
 [0.67152856]
 [0.66032145]
 [0.6411306 ]
 [0.60530204]
 [0.58357841]
 [0.60250285]
 [0.79282179]
 [0.44650736]
 [0.41859717]
 [0.60030859]
 [0.64375378]
 [0.73370373]
 [0.73869353]
 [0.71586416]
 [0.73856667]
 [0.67440441]
 [0.63484111]
 [0.66171541]
 [0.85345467]
 [0.50409226]
 [0.46442449]
 [0.66672364]
 [0.69262367]
 [0.84791621]
 [0.81956809]
 [0.75762571]
 [0.80093142]
 [0.7067105 ]
 [0.70711449]
 [0.74005813]
 [0.89864748]
 [0.59274697]
 [0.55703637]
 [0.67018796]
 [0.77815322]
 [0.89130104]
 [0.82881558]
 [0.85429556]
 [0.82665694]
 [0.7738504 ]
 [0.77447937]
 [0.7122942 ]
 [0.84218578]
 [0.54973668]
 [0.4726908 ]
 [0.619567  ]
 [0.70299771]
 [0.8118506 ]
 [0.79730487]
 [0.80781639]
 [0.7709681 ]
 [0.75444661]
 [0.77368724]
 [0.71629034]
 [0.92972161]
 [0.59734863]
 [0.53166512]
 [0.73605008]
 [0.78453641]
 [0.84759795]
 [0.8653115 ]
 [0.86398323]
 [0.81439355]
 [0.79916654]
 [0.80210057]
 [0.81482896]
 [1.        ]]
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #
=================================================================
 lstm (LSTM)                 (None, 20)                1760

 dense (Dense)               (None, 1)                 21

=================================================================
Total params: 1,781
Trainable params: 1,781
Non-trainable params: 0
_________________________________________________________________
Epoch 1/100
8/8 [==============================] - 6s 58ms/step - loss: 0.2542
Epoch 2/100
8/8 [==============================] - 0s 20ms/step - loss: 0.1363
Epoch 3/100
8/8 [==============================] - 0s 37ms/step - loss: 0.0590
Epoch 4/100
8/8 [==============================] - 0s 9ms/step - loss: 0.0243
Epoch 5/100
8/8 [==============================] - 0s 49ms/step - loss: 0.0219
Epoch 6/100
8/8 [==============================] - 0s 14ms/step - loss: 0.0198
Epoch 7/100
8/8 [==============================] - 0s 17ms/step - loss: 0.0157
Epoch 8/100
8/8 [==============================] - 0s 13ms/step - loss: 0.0151
Epoch 9/100
8/8 [==============================] - 0s 15ms/step - loss: 0.0140
Epoch 10/100
8/8 [==============================] - 0s 40ms/step - loss: 0.0126
Epoch 11/100
8/8 [==============================] - 0s 49ms/step - loss: 0.0118
Epoch 12/100
8/8 [==============================] - 0s 23ms/step - loss: 0.0111
Epoch 13/100
8/8 [==============================] - 0s 48ms/step - loss: 0.0105
Epoch 14/100
8/8 [==============================] - 0s 16ms/step - loss: 0.0100
Epoch 15/100
8/8 [==============================] - 0s 16ms/step - loss: 0.0096
Epoch 16/100
8/8 [==============================] - 0s 20ms/step - loss: 0.0093
Epoch 17/100
8/8 [==============================] - 0s 26ms/step - loss: 0.0091
Epoch 18/100
8/8 [==============================] - 0s 16ms/step - loss: 0.0089
Epoch 19/100
8/8 [==============================] - 0s 15ms/step - loss: 0.0088
Epoch 20/100
8/8 [==============================] - 0s 44ms/step - loss: 0.0087
Epoch 21/100
8/8 [==============================] - 0s 43ms/step - loss: 0.0086
Epoch 22/100
8/8 [==============================] - 0s 33ms/step - loss: 0.0086
Epoch 23/100
8/8 [==============================] - 0s 9ms/step - loss: 0.0085
Epoch 24/100
8/8 [==============================] - 0s 8ms/step - loss: 0.0086
Epoch 25/100
8/8 [==============================] - 0s 11ms/step - loss: 0.0085
Epoch 26/100
8/8 [==============================] - 0s 9ms/step - loss: 0.0085
Epoch 27/100
8/8 [==============================] - 0s 9ms/step - loss: 0.0084
Epoch 28/100
8/8 [==============================] - 0s 10ms/step - loss: 0.0084
Epoch 29/100
8/8 [==============================] - 0s 7ms/step - loss: 0.0084
Epoch 30/100
8/8 [==============================] - 0s 26ms/step - loss: 0.0084
Epoch 31/100
8/8 [==============================] - 0s 33ms/step - loss: 0.0083
Epoch 32/100
8/8 [==============================] - 0s 9ms/step - loss: 0.0083
Epoch 33/100
8/8 [==============================] - 0s 11ms/step - loss: 0.0082
Epoch 34/100
8/8 [==============================] - 0s 16ms/step - loss: 0.0082
Epoch 35/100
8/8 [==============================] - 0s 29ms/step - loss: 0.0082
Epoch 36/100
8/8 [==============================] - 0s 20ms/step - loss: 0.0082
Epoch 37/100
8/8 [==============================] - 0s 22ms/step - loss: 0.0082
Epoch 38/100
8/8 [==============================] - 0s 11ms/step - loss: 0.0081
Epoch 39/100
8/8 [==============================] - 0s 26ms/step - loss: 0.0081
Epoch 40/100
8/8 [==============================] - 0s 11ms/step - loss: 0.0081
Epoch 41/100
8/8 [==============================] - 0s 14ms/step - loss: 0.0081
Epoch 42/100
8/8 [==============================] - 0s 16ms/step - loss: 0.0080
Epoch 43/100
8/8 [==============================] - 0s 14ms/step - loss: 0.0080
Epoch 44/100
8/8 [==============================] - 0s 20ms/step - loss: 0.0080
Epoch 45/100
8/8 [==============================] - 0s 49ms/step - loss: 0.0080
Epoch 46/100
8/8 [==============================] - 1s 85ms/step - loss: 0.0079
Epoch 47/100
8/8 [==============================] - 0s 39ms/step - loss: 0.0079
Epoch 48/100
8/8 [==============================] - 0s 28ms/step - loss: 0.0080
Epoch 49/100
8/8 [==============================] - 0s 13ms/step - loss: 0.0079
Epoch 50/100
8/8 [==============================] - 0s 22ms/step - loss: 0.0078
Epoch 51/100
8/8 [==============================] - 0s 14ms/step - loss: 0.0079
Epoch 52/100
8/8 [==============================] - 0s 21ms/step - loss: 0.0078
Epoch 53/100
8/8 [==============================] - 0s 11ms/step - loss: 0.0077
Epoch 54/100
8/8 [==============================] - 0s 10ms/step - loss: 0.0077
Epoch 55/100
8/8 [==============================] - 0s 12ms/step - loss: 0.0077
Epoch 56/100
8/8 [==============================] - 0s 11ms/step - loss: 0.0077
Epoch 57/100
8/8 [==============================] - 0s 9ms/step - loss: 0.0076
Epoch 58/100
8/8 [==============================] - 0s 10ms/step - loss: 0.0076
Epoch 59/100
8/8 [==============================] - 0s 20ms/step - loss: 0.0075
Epoch 60/100
8/8 [==============================] - 0s 20ms/step - loss: 0.0075
Epoch 61/100
8/8 [==============================] - 0s 21ms/step - loss: 0.0075
Epoch 62/100
8/8 [==============================] - 0s 23ms/step - loss: 0.0077
Epoch 63/100
8/8 [==============================] - 0s 42ms/step - loss: 0.0076
Epoch 64/100
8/8 [==============================] - 1s 66ms/step - loss: 0.0074
Epoch 65/100
8/8 [==============================] - 0s 31ms/step - loss: 0.0075
Epoch 66/100
8/8 [==============================] - 0s 25ms/step - loss: 0.0073
Epoch 67/100
8/8 [==============================] - 0s 13ms/step - loss: 0.0074
Epoch 68/100
8/8 [==============================] - 0s 17ms/step - loss: 0.0073
Epoch 69/100
8/8 [==============================] - 0s 14ms/step - loss: 0.0072
Epoch 70/100
8/8 [==============================] - 0s 19ms/step - loss: 0.0072
Epoch 71/100
8/8 [==============================] - 0s 14ms/step - loss: 0.0072
Epoch 72/100
8/8 [==============================] - 0s 14ms/step - loss: 0.0072
Epoch 73/100
8/8 [==============================] - 0s 56ms/step - loss: 0.0071
Epoch 74/100
8/8 [==============================] - 0s 39ms/step - loss: 0.0071
Epoch 75/100
8/8 [==============================] - 0s 24ms/step - loss: 0.0072
Epoch 76/100
8/8 [==============================] - 1s 98ms/step - loss: 0.0072
Epoch 77/100
8/8 [==============================] - 0s 27ms/step - loss: 0.0070
Epoch 78/100
8/8 [==============================] - 0s 30ms/step - loss: 0.0070
Epoch 79/100
8/8 [==============================] - 0s 28ms/step - loss: 0.0069
Epoch 80/100
8/8 [==============================] - 0s 22ms/step - loss: 0.0070
Epoch 81/100
8/8 [==============================] - 0s 15ms/step - loss: 0.0072
Epoch 82/100
8/8 [==============================] - 0s 16ms/step - loss: 0.0069
Epoch 83/100
8/8 [==============================] - 0s 17ms/step - loss: 0.0070
Epoch 84/100
8/8 [==============================] - 0s 8ms/step - loss: 0.0068
Epoch 85/100
8/8 [==============================] - 0s 8ms/step - loss: 0.0068
Epoch 86/100
8/8 [==============================] - 0s 8ms/step - loss: 0.0067
Epoch 87/100
8/8 [==============================] - 0s 8ms/step - loss: 0.0067
Epoch 88/100
8/8 [==============================] - 0s 8ms/step - loss: 0.0067
Epoch 89/100
8/8 [==============================] - 0s 13ms/step - loss: 0.0066
Epoch 90/100
8/8 [==============================] - 0s 9ms/step - loss: 0.0067
Epoch 91/100
8/8 [==============================] - 0s 6ms/step - loss: 0.0066
Epoch 92/100
8/8 [==============================] - 0s 8ms/step - loss: 0.0065
Epoch 93/100
8/8 [==============================] - 0s 8ms/step - loss: 0.0065
Epoch 94/100
8/8 [==============================] - 0s 12ms/step - loss: 0.0064
Epoch 95/100
8/8 [==============================] - 0s 15ms/step - loss: 0.0064
Epoch 96/100
8/8 [==============================] - 0s 22ms/step - loss: 0.0064
Epoch 97/100
8/8 [==============================] - 0s 23ms/step - loss: 0.0064
Epoch 98/100
8/8 [==============================] - 0s 42ms/step - loss: 0.0066
Epoch 99/100
8/8 [==============================] - 0s 19ms/step - loss: 0.0064
Epoch 100/100
8/8 [==============================] - 0s 24ms/step - loss: 0.0063
2/2 [==============================] - 1s 6ms/step
[[0.81726146]
 [0.8352456 ]
 [0.88046104]
 [0.8961175 ]
 [0.9040771 ]
 [0.9054257 ]
 [0.89792234]
 [0.8941482 ]
 [0.89175683]
 [0.88997024]
 [0.89607865]
 [0.9074178 ]
 [0.8520239 ]
 [0.872488  ]
 [0.90936977]
 [0.914689  ]
 [0.93497205]
 [0.92621315]
 [0.9158394 ]
 [0.91887087]
 [0.90923434]
 [0.9123991 ]
 [0.9158543 ]
 [0.92136276]
 [0.88235146]
 [0.89770466]
 [0.9424339 ]
 [0.96007425]
 [0.98201674]
 [0.9678742 ]
 [0.96792924]
 [0.9686193 ]
 [0.9550987 ]
 [0.9642218 ]
 [0.9656859 ]
 [0.96872246]
 [0.93048924]
 [0.94421804]
 [0.9888901 ]
 [1.013566  ]
 [1.0305324 ]
 [1.0153302 ]
 [1.015705  ]
 [1.006036  ]
 [0.99697006]
 [0.9971844 ]
 [0.9902999 ]
 [0.9943838 ]
 [0.94445103]
 [0.96349025]
 [1.0139354 ]
 [1.037991  ]
 [1.058495  ]
 [1.0491736 ]
 [1.0480529 ]
 [1.0363362 ]
 [1.0318968 ]
 [1.0329168 ]
 [1.0276546 ]
 [1.0374784 ]
 [0.98974484]]
Mean squared error: 0.01
