![[3-4) 5장. IPv4 주소 (87 pages)_page-0001.jpg]]

![[3-4) 5장. IPv4 주소 (87 pages)_page-0002.jpg]]

## 5.1. 개요
![[3-4) 5장. IPv4 주소 (87 pages)_page-0003.jpg]]
- IPv4를 이해하면 인터넷이 왜 그렇게 동작하는지 이해할 수 있다.

- IPv4의 주소 공간은 약 43억개이다.
- 그 43억개를 계층 3에서 구분할 수 있다.
- IP 주소는 인터페이스 주소이다.
	- IP 주소는 장치를 식별하는 것이 아니라 인터페이스를 식별하는 것이다.
- 3계층 프로토콜에는 여러 프로토콜이 있는데 그 중 대표가 IP 프로토콜이고, IP 프로토콜이라고 부르면 3계층, 즉 네트워크 계층인 것이다.(일반적으로 IP 계층이라고 불러버림)
![[3-4) 5장. IPv4 주소 (87 pages)_page-0004.jpg]]

![[3-4) 5장. IPv4 주소 (87 pages)_page-0005.jpg]]
- 컴퓨터는 당연히 이진법으로 저장함.
- 하지만 우리가 이해하고, 통용하길 십진법 + 점을 사용함.
	- 이 것을 Dotted decimal 이 들어간다.

![[3-4) 5장. IPv4 주소 (87 pages)_page-0006.jpg]]

![[3-4) 5장. IPv4 주소 (87 pages)_page-0007.jpg]]

![[3-4) 5장. IPv4 주소 (87 pages)_page-0008.jpg]]

![[3-4) 5장. IPv4 주소 (87 pages)_page-0009.jpg]]

![[3-4) 5장. IPv4 주소 (87 pages)_page-0010.jpg]]

![[3-4) 5장. IPv4 주소 (87 pages)_page-0011.jpg]]

![[3-4) 5장. IPv4 주소 (87 pages)_page-0012.jpg]]

![[3-4) 5장. IPv4 주소 (87 pages)_page-0013.jpg]]

![[3-4) 5장. IPv4 주소 (87 pages)_page-0014.jpg]]

![[3-4) 5장. IPv4 주소 (87 pages)_page-0015.jpg]]


## 5.2. 클래스기반 주소지정
![[3-4) 5장. IPv4 주소 (87 pages)_page-0016.jpg]]
- 용어는 되도록이면 영어로 외우자.

![[3-4) 5장. IPv4 주소 (87 pages)_page-0017.jpg]]


### 5.2.1. 클래스(class)
![[3-4) 5장. IPv4 주소 (87 pages)_page-0018.jpg]]

![[3-4) 5장. IPv4 주소 (87 pages)_page-0019.jpg]]

![[3-4) 5장. IPv4 주소 (87 pages)_page-0020.jpg]]

![[3-4) 5장. IPv4 주소 (87 pages)_page-0021.jpg]]

![[3-4) 5장. IPv4 주소 (87 pages)_page-0022.jpg]]


### 5.2.2. 클래스와 블록(class and blocks)
![[3-4) 5장. IPv4 주소 (87 pages)_page-0023.jpg]]
- 이 피겨는 A클래스가 가장 좋은 클래스인 것으로 설계한 것이다.

- 100개를 나눠줘야하는 경우일 때 
	- 1명에게 100개씩 나눠주느냐
	- 2명에게 50개씩 위임하느냐
- 이 경우는 '위임'하는 경우이다.

- ![[Pasted image 20250319140045.png|300]]256개, $2^{24}$에서 조금 줄어들긴 한다.

![[3-4) 5장. IPv4 주소 (87 pages)_page-0024.jpg]]
- 클래스 A에서 하나의 Netid를 할당받으면 1600만개의 주소를 사용할 수 있다.
- 클래스 A, B, C는 기관에 할당되고, D, E는 멀티캐스팅, 미래 사용을 위해 기관에 할당되지 않는다.
	- 

![[3-4) 5장. IPv4 주소 (87 pages)_page-0025.jpg]]

![[3-4) 5장. IPv4 주소 (87 pages)_page-0026.jpg]]

### 5.2.3. 2계층 주소지정
![[3-4) 5장. IPv4 주소 (87 pages)_page-0027.jpg]]
- 네트워크 주소가 netid와 hostid, 이렇게 2개의 계층으로 구성되어 있어서 2계층 주소 지정이라고 말한다.

![[3-4) 5장. IPv4 주소 (87 pages)_page-0028.jpg]]

![[3-4) 5장. IPv4 주소 (87 pages)_page-0029.jpg]]
- 예를 들어 삼성전자가 할당받은 netid에 대해서는 그 뒤의 hostid를 서로 다르게 하여 삼성전자 직원들에게 할당하는 것이다.

- 참고로 물리 주소는 주변에만 같은 물리주소를 가진 기기가 없으면 되어서 유일할 필요 없다고 생각할 수 있지만 그 기기를 어디에 설치할지 모르는 거라 현실적으로는 유일해야한다.
	- 위 2계층 주소지정 방법으로 물리주소를 유일하게 만든다.
![[3-4) 5장. IPv4 주소 (87 pages)_page-0030.jpg]]
- 첫 주소는 Network address이다.
- 마지막 주소는 Special address이다.
- 이 그림에서 컴퓨터에 할당할 수 있는 주소의 수는 $2^{24} - 2$개 이다.
![[3-4) 5장. IPv4 주소 (87 pages)_page-0031.jpg]]

![[3-4) 5장. IPv4 주소 (87 pages)_page-0032.jpg]]

![[3-4) 5장. IPv4 주소 (87 pages)_page-0033.jpg]]

![[3-4) 5장. IPv4 주소 (87 pages)_page-0034.jpg]]

![[3-4) 5장. IPv4 주소 (87 pages)_page-0035.jpg]]

![[3-4) 5장. IPv4 주소 (87 pages)_page-0036.jpg]]
- 하나의 라우터에는 여러 개의 주소가 할당될 수 있다.
https://florescene.tistory.com/157

- Switched
	- 네트워크 연결이 필요할 때만 만들어지고, 사용이 끝나면 끊어지는 동적 방식을 의미해요. 쉽게 말해, 우리가 전화를 걸 때마다 연결이 생기고, 통화가 끝나면 끊어지는 것과 비슷해요. 그래서 네트워크 자원을 효율적으로 사용할 수 있죠.

![[3-4) 5장. IPv4 주소 (87 pages)_page-0037.jpg]]
- 송신지 -> 라우터 -> 목적지
	- Network1에서 라우터로 데이터그램을 보낼 때, 
	- 데이터 그램을 받으면 3계층 봉투 헤더에 송신자 주소와 목적지 주소가 있다.
	- 목적지 주소는 뜯어낼 수 있고 라우터는 네트워크 주소를 찾는다. 이는 그 블락의 첫 번째 주소이다.
	- 각 블락에 네트워크 주소를 달아놓고 리니어 서치로 찾으면 된다. 
	- 찾은 다음 그 곳으로 데이터그램을 보내준다.
![[3-4) 5장. IPv4 주소 (87 pages)_page-0038.jpg]]

![[3-4) 5장. IPv4 주소 (87 pages)_page-0039.jpg]]

![[3-4) 5장. IPv4 주소 (87 pages)_page-0040.jpg]]

![[3-4) 5장. IPv4 주소 (87 pages)_page-0041.jpg]]
- Exchange(교환기)
	- 031-8005-xxxx'에서 8005는 교환기이다. 
	- 이 것을 보고 단국대임을 알 수 있다.
	- 4G/5G부터는 All IP로 바뀌면서 교환기가 없어졌다.
	- 하지만 1G/2G/3G는 교환기가 존재한다.


^0319
![[3-4) 5장. IPv4 주소 (87 pages)_page-0042.jpg]]

![[3-4) 5장. IPv4 주소 (87 pages)_page-0043.jpg]]

![[3-4) 5장. IPv4 주소 (87 pages)_page-0044.jpg]]

![[3-4) 5장. IPv4 주소 (87 pages)_page-0045.jpg]]

![[3-4) 5장. IPv4 주소 (87 pages)_page-0046.jpg]]
[[2) 2장. OSI 모델과 TCP-IP 프로토콜 (31 pages)#2.4 주소지정| Port(포트) 개념은 서브넷(subnet)이랑은 완전히 다른 계층에서 나오는 개념이다.]]


![[3-4) 5장. IPv4 주소 (87 pages)_page-0047.jpg]]

![[3-4) 5장. IPv4 주소 (87 pages)_page-0048.jpg]]

![[3-4) 5장. IPv4 주소 (87 pages)_page-0049.jpg]]

![[3-4) 5장. IPv4 주소 (87 pages)_page-0050.jpg]]

![[3-4) 5장. IPv4 주소 (87 pages)_page-0051.jpg]]

![[3-4) 5장. IPv4 주소 (87 pages)_page-0052.jpg]]

![[3-4) 5장. IPv4 주소 (87 pages)_page-0053.jpg]]

![[3-4) 5장. IPv4 주소 (87 pages)_page-0054.jpg]]

![[3-4) 5장. IPv4 주소 (87 pages)_page-0055.jpg]]

![[3-4) 5장. IPv4 주소 (87 pages)_page-0056.jpg]]

![[3-4) 5장. IPv4 주소 (87 pages)_page-0057.jpg]]

![[3-4) 5장. IPv4 주소 (87 pages)_page-0058.jpg]]

![[3-4) 5장. IPv4 주소 (87 pages)_page-0059.jpg]]

![[3-4) 5장. IPv4 주소 (87 pages)_page-0060.jpg]]

![[3-4) 5장. IPv4 주소 (87 pages)_page-0061.jpg]]

![[3-4) 5장. IPv4 주소 (87 pages)_page-0062.jpg]]
- c.에서  1024로 나누어지는 값을 시작 주소로 선택하지 않는다면
	- 주소에 마스크를 씌워 ---를 뽑아낼 수 있는데 1024로 나누어지지 않는 값을 시작 주소로 한다면 문제가 생긴다.

![[3-4) 5장. IPv4 주소 (87 pages)_page-0063.jpg]]

![[3-4) 5장. IPv4 주소 (87 pages)_page-0064.jpg]]

![[3-4) 5장. IPv4 주소 (87 pages)_page-0065.jpg]]

![[3-4) 5장. IPv4 주소 (87 pages)_page-0066.jpg]]

![[3-4) 5장. IPv4 주소 (87 pages)_page-0067.jpg]]

![[3-4) 5장. IPv4 주소 (87 pages)_page-0068.jpg]]

![[3-4) 5장. IPv4 주소 (87 pages)_page-0069.jpg]]

![[3-4) 5장. IPv4 주소 (87 pages)_page-0070.jpg]]

![[3-4) 5장. IPv4 주소 (87 pages)_page-0071.jpg]]

![[3-4) 5장. IPv4 주소 (87 pages)_page-0072.jpg]]
ISP: Internet Service Provider

![[3-4) 5장. IPv4 주소 (87 pages)_page-0073.jpg]]
$2^{14}$는 $2^{16}$의 4분의 1이므로 2비트가 필요 -> 코딩할 때는 슬래시 18

![[3-4) 5장. IPv4 주소 (87 pages)_page-0074.jpg]]
기계적인, 인간적인 계산법이 있다. -> 둘 다 연습하기

![[3-4) 5장. IPv4 주소 (87 pages)_page-0075.jpg]]
이들을 슬래시18 네트워크, 슬래시19 네트워크라고 부르심.

블락 하나 받아서 -> 브라이빗 라우터 받아서 -> 여러개 네트워크를 나눈다.

## 5.4. 특수 주소(Special Addresses)
https://like-grapejuice.tistory.com/106#toc0
![[3-4) 5장. IPv4 주소 (87 pages)_page-0076.jpg]]

![[3-4) 5장. IPv4 주소 (87 pages)_page-0077.jpg]]

![[3-4) 5장. IPv4 주소 (87 pages)_page-0078.jpg]]
![[Pasted image 20250420005157.png|600]]


- 0.0.0.0 주소(all-zero 주소)는 누가 언제 사용할까?
	- IP 주소를 아직 할당받지 못한 디바이스가 사용한다.
	- 이 all-zero 주소가 적혀있는 걸 받는 사람은 '이 사람이 본인 주소를 모르는구나' 라고 생각하게 된다.

- 왜 ’특수 블록(Special Block)’이라고 하나?
	- 0.0.0.0은 단일 주소처럼 보이지만, 실제로는 특수한 목적을 가진 주소 블록으로 정의돼 있음.
	- 예를 들어, 0.0.0.0/8 전체 블록은 예약되어 있으며,
	- 이 중에서 0.0.0.1 ~ 0.255.255.255는 일반 IP로 사용되지 않음.

- 중요한 특징
	- 0.0.0.0은 절대 목적지 주소로 사용되지 않음.
	- 루프백(127.0.0.0/8)처럼, 블록 전체가 특정 기능을 위해 예약된 것임.
	- 따라서, 0.0.0.1과 같은 주소도 사용 불가.

- 올 255 주소는 다음 슬라이드에

![[3-4) 5장. IPv4 주소 (87 pages)_page-0079.jpg]]
- all-255주소는 '제한된 브로드캐스트 주소'이다.
	- 타 통신과 간섭이 일어나 통신 실패가 되지 않도록 라우터가 패킷을 block한다.
- all-zero 주소는 목적지에 사용될 수 없다.
	- 왜냐하면, 올제로 주소는 자기 주소를 모르는 디바이스가 IP 패킷을 보낼 때 사용하는 것이므로 목적지에는 사용할 수 없다.

![[3-4) 5장. IPv4 주소 (87 pages)_page-0080.jpg]]
- 127.0.0.1과 같이 127로 시작하는 네트워크 주소는 루프백 주소이다.

- 네트워크 테스트를 할 때, 루프백 주소로 시험하여, 프로그램을 잘못짜서 네트워크가 죽는 상황을 방지한다.


![[3-4) 5장. IPv4 주소 (87 pages)_page-0081.jpg]]
- 알고리즘 중의 directed graph에서 알 수 있듯이 'directed'는 '방향이 있는', '지시된'으로 해석하는게 낫다.
	- 번역이 잘못됐다.
- 방향을 알리는 방법은 prefix는 살리고 suffix를 모두 1로 바꾸면 된다.

![[Pasted image 20250420005505.png]]


![[3-4) 5장. IPv4 주소 (87 pages)_page-0082.jpg]]
- 챗지피티한테 물어보면 사설 ip는 10, 192, 192만 알려줄거다.
- 169번대 사설 ip는 dhcp서버가 없어서 받는 걸 실패할 수 있으므로...
- dhcp 서버가 없어서 스스로 주소를 만들어내야할 때 169번대 사설 ip주소를 사용한다.
- 그런데 누군가가 사용하고있지 않을까?
	- 이걸 쓰고싶은 사람은 우선 169.----로 패킷을 보내본다. 답이 오면 쓰고있는 사람이 있는 거고, 답이 안오면 쓰고있는 사람이 없는 거다.
		- 답이 안 오면 쓸 수 있다.
	- 링크 로컬 주소라고 부른다.

**링크 로컬 주소**
![[Pasted image 20250420005853.png|400]]

## 5.5. NAT
![[3-4) 5장. IPv4 주소 (87 pages)_page-0083.jpg]]
- NAT는 private networks를 구축하기 위해서 사용한다.
- 

- 요즘 NAT를 안 쓰고 IPv6를 사용한다.

![[3-4) 5장. IPv4 주소 (87 pages)_page-0084.jpg]]

![[3-4) 5장. IPv4 주소 (87 pages)_page-0085.jpg]]
Figure 5.40
라우터(무선 AP)가 공인 IP 주소로 바꾼다.
그런데 통신 도중에 다른 디바이스가 다른 통신을 시도할텐데 이건 현실적으로 말이 안되는 그림이다.
(다음 슬라이드에서 해결: 변환 테이블을 만든다.)

![[3-4) 5장. IPv4 주소 (87 pages)_page-0086.jpg]]
private add & Universal add를 적어놓은 Table을 만든다.
그런데 모든 디바이스가 네이버에 접속한다면 Universal 주소가 같을 것이라서 다른 해결책이 추가로 필요하다.

![[3-4) 5장. IPv4 주소 (87 pages)_page-0087.jpg]]
reliable한 Process to Process communication(4계층에서 사용됨)
	4계층에서는 port 주소를 사용(참고로 3계층에서는 IP 주소를 사용)

포트번호를 사용해서 해결한다.
하지만!! 그래도 문제가 발생한다.
왜냐하면 포트 주소는 2바이트이다. 6만 5천 몇 개만 사용할 수 있으므로 여기서 충돌이 일어날 수 있다.
이를 해결하는 방법이 이미 사용되고 있다. -> 찾아보기

![[Pasted image 20250420183654.png|500]]

![[Pasted image 20250420183726.png|500]]